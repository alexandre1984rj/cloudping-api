version: 0.1

environment_variables:
  plaintext:
    Variables: "go here"

phases:
  install:
    commands:
      - mkdir lambda
      - pip install --upgrade pip
      - pip install numpy --target=./lambda
  pre_build:
    commands:
      - yum install zip -y
      - cp lambda.py lambda/lambda.py
  build:
    commands:
      - zip -r lambda.zip lambda/lambda.py lambda/numpy*
      - zipinfo lambda.zip
  post_build:
    commands:
      - aws cloudformation package --template deploy.yml --output-template-file serverless-deploy.yml --s3-bucket mda-cloudformation

artifacts:
  files:
    - lambda.zip
    - swagger-2.yml
    - serverless-deploy.yml